<!--
Copyright 2011 Hans Beemsterboer

This file is part of the TechyTax program.

TechyTax is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 3 of the License, or
(at your option) any later version.

TechyTax is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with TechyTax; if not, write to the Free Software
Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
-->
<!DOCTYPE sqlMap 
          PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
          "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Kostmatch">
	<typeAlias alias="kostmatch" type="org.techytax.domain.Kostmatch" />
	<typeAlias alias="key" type="org.techytax.domain.KeyId" />		
	<select id="getKostmatchLijst" resultClass="kostmatch">
		SELECT id, kostensoort_id as kostenSoortId, match_text as matchText 
		FROM kostmatch
	</select>
	<select id="getCostMatchPrivateList" parameterClass="string" resultClass="kostmatch">
		SELECT id, kostensoort_id as kostenSoortId, match_text as matchText 
		FROM kostmatch_private
		WHERE user_id = #value#
	</select>	
	<select id="getKostmatchLijstForId" parameterClass="string" resultClass="kostmatch">
		SELECT k.id, kostensoort_id as kostenSoortId, match_text as matchText, b.btw_type as btwType
		FROM kostmatch as k 
		LEFT OUTER JOIN btwmatch as b ON k.id = b.kostmatch_id 
		WHERE k.kostensoort_id = #value#;
	</select>
	<select id="getCostMatchPrivateListForId" parameterClass="key" resultClass="kostmatch">
		SELECT k.id, kostensoort_id as kostenSoortId, match_text as matchText, b.btw_type as btwType
		FROM kostmatch_private as k 
		LEFT OUTER JOIN btwmatch_private as b ON k.id = b.kostmatch_id 
		WHERE k.kostensoort_id = #id#
		AND k.user_id = #userId#;
	</select>		
	<insert id="insertKostmatch" parameterClass="kostmatch">
		insert into kostmatch
		values(#id#,#kostenSoortId#,#matchText#)
	</insert>
	<insert id="insertCostMatchPrivate" parameterClass="kostmatch">
		insert into kostmatch_private
		values(#id#,#userId#,#kostenSoortId#,#matchText#)
	</insert>	
	<select id="getKostmatch" parameterClass="string"
		resultClass="kostmatch">
		SELECT k.id, kostensoort_id as kostenSoortId, match_text as matchText, b.btw_type as btwType
		FROM kostmatch as k 
		LEFT OUTER JOIN btwmatch as b ON k.id = b.kostmatch_id 
		WHERE k.id = #value#;
	</select>
	<select id="getCostMatchPrivate" parameterClass="key"
		resultClass="kostmatch">
		SELECT k.id, kostensoort_id as kostenSoortId, match_text as matchText, b.btw_type as btwType
		FROM kostmatch_private as k 
		LEFT OUTER JOIN btwmatch as b ON k.id = b.kostmatch_id 
		WHERE k.id = #id#
		AND k.user_id = #userId#;
	</select>	
	<update id="updateKostmatch" parameterClass="kostmatch">
		update kostmatch set match_text = #matchText#
		WHERE id = #id#
	</update>
	<update id="updateCostMatchPrivate" parameterClass="kostmatch">
		update kostmatch_private set match_text = #matchText#
		WHERE id = #id#
		AND user_id = #userId#
	</update>	
</sqlMap>